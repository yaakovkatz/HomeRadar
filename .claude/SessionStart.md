# HomeRadar - מערכת אוטומטית לסינון דירות מפייסבוק

## מה זה HomeRadar?

HomeRadar היא מערכת Python שסורקת קבוצות פייסבוק לדירות להשכרה, ומסננת אוטומטית:
- ✅ דירות רלוונטיות (בערים מסוימות)
- ❌ מתווכים (brokers)
- ❌ סאבלטים/שותפים לדירה
- ❌ מכרזים וכונסי נכסים
- ❌ דירות ביישובים/מושבים
- 🟡 מתווכים חשודים (לבדיקה ידנית)

המערכת משתמשת ב-AI (Claude API) לסינון חכם + regex patterns.

---

## ארכיטקטורה

### קבצים עיקריים:
- **`main.py`** - נקודת כניסה, מריץ את כל המערכת
- **`scraper.py`** - קריאת פוסטים מפייסבוק (playwright)
- **`ai_agents.py`** - 2 AI agents לסינון חכם
- **`database.py`** - SQLite DB + פונקציות עיבוד
- **`config.json`** - הגדרות (ערים, מילות חסימה, וכו')
- **`gui.py`** - ממשק טבלה (tkinter) להצגת תוצאות

### מסד נתונים:
- **SQLite**: `facebook_posts.db`
- טבלה: `posts` עם כל המידע + סינון AI
- צבעים בGUI: ירוק (רלוונטי), אדום (מתווך), צהוב (חשוד)

---

## פקודות ריצה נפוצות

### הרצת המערכת:
```bash
python main.py
```
זה מריץ:
1. Scraper (playwright)
2. AI filtering (2 agents)
3. Regex patterns
4. GUI להצגה

### בדיקת מערכת:
```bash
# בדיקת DB
sqlite3 facebook_posts.db "SELECT COUNT(*) FROM posts;"

# צפייה בלוגים אחרונים
tail -f scraper.log

# הרצת validation
/validate-setup
```

---

## AI Filtering System

### Agent 1 - סינון ראשוני:
קטגוריות:
- `RELEVANT` - דירות רלוונטיות ✅
- `BROKER` - מתווך ודאי ❌
- `SUSPECTED_BROKER` - חשוד למתווך 🟡
- `NON_URBAN` - יישוב/מושב ❌
- `AUCTION` - מכרז/כונס נכסים ❌
- `ROOMMATE` - סאבלט/שותף לדירה ❌

### Agent 2 - זיהוי מתווכים (רק אם RELEVANT):
מנתח לעומק אם יש:
- מספר רישיון תיווך
- דפוסים של מתווך (טלפון, "מגוון דירות", וכו')

---

## broker_keywords (חשוב!)

**`config.json` → `broker_keywords`** = רשימת מילים שחוסמות פוסט **לפני** AI!

למה? **חוסך כסף!** (פחות קריאות API)

### איך מוסיפים מילים:
1. **ידנית** - ערוך `config.json` והוסף למערך `broker_keywords`
2. **אוטומטית** - הרץ `/tune-ai` והוא ימצא דפוסים חוזרים

דוגמאות טובות:
- שמות מתווכים: "דן נדל״ן", "יוסי מתווך"
- מספרי טלפון חוזרים: "052-5555555"
- חתימות: "מתווך מוסמך #12345"

---

## Skills זמינים

### `/validate-setup`
בודק שהכל תקין:
- קבצים קיימים
- DB נגיש
- Config תקין

### `/tune-ai`
**מומלץ להריץ שבועי/חודשי!**

מנתח את ה-DB ומציע:
- מתווכים חדשים ל-broker_keywords
- settlements חדשים
- blacklist terms
- פוסטים שסווגו לא נכון

---

## טיפים

1. **SUSPECTED_BROKER בטרמינל:**
   כשהמערכת רצה, יוצגו מתווכים חשודים בפורמט ברור עם:
   - 👤 מחבר
   - 📄 תוכן
   - ⚠️ סיבת חשד
   - 📊 רמת ביטחון

2. **שכונות בירושלים:**
   כלל זהב - אם קבוצה מכילה "ירושלים", כל שכונה רלוונטית (גם לא מוכרות!)
   סינון רק אם יש: "מושב", "יישוב", "כפר", "התנחלות"

3. **Git workflow:**
   - Branch pattern: `claude/new-chat-session-XXXXX`
   - תמיד push עם: `git push -u origin <branch-name>`
   - .gitignore מסנן `*.backup.*`

4. **עדכונים אחרונים:**
   - קטגוריית ROOMMATE מסננת סאבלטים/שותפים
   - לוגים מפורטים ל-SUSPECTED_BROKER בטרמינל
   - תיקון שכונות לא מוכרות (מורדות גילה וכו')

---

## הגדרות config.json

```json
{
  "relevant_cities": ["ירושלים", "בית שמש", ...],
  "broker_keywords": ["רשימת מילים לחסימה"],
  "scraping": {
    "groups": ["URL של קבוצות פייסבוק"],
    "max_scroll_count": 5
  }
}
```

---

## FAQ מהיר

**Q: איך אני רואה פוסטים שנשמרו?**
A: המערכת מציגה GUI אוטומטית, או `sqlite3 facebook_posts.db` בטרמינל

**Q: איך מוסיפים קבוצת פייסבוק חדשה?**
A: ערוך `config.json` → `scraping.groups` והוסף URL

**Q: למה יש 2 AI agents?**
A: Agent 1 מסנן קטגוריות בסיסיות, Agent 2 מתמחה בזיהוי מתווכים

**Q: איך לדעת אם broker_keywords עובד?**
A: הרץ `/tune-ai` ותראה כמה פוסטים נחסמו לפני AI (חיסכון!)

---

🎯 **מוכן לעבודה! בהצלחה עם HomeRadar!**
